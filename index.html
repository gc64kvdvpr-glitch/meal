<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†¡ì–‘ê³  ì˜¤ëŠ˜ ì ì‹¬</title>
    <style>
        /* ë…¸ì…˜ ì„ë² ë“œì— ìµœì í™”ëœ ì‹¬í”Œ ë””ìì¸ */
        body { 
            margin: 0; 
            padding: 20px; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            background-color: #ffffff; 
            color: #37352f; 
        }
        h3 { 
            margin: 0 0 10px 0; 
            font-size: 16px; 
            color: #eb5757; /* ë¶‰ì€ìƒ‰ í¬ì¸íŠ¸ */
            font-weight: 600; 
        }
        .menu { 
            font-size: 14px; 
            line-height: 1.6; 
            white-space: pre-wrap; 
            word-break: keep-all; 
        }
        .kcal {
            margin-top: 8px;
            font-size: 12px;
            color: #888;
        }
        .error { color: #e03e3e; font-size: 13px; }
    </style>
</head>
<body>
    <div id="container">
        <h3>ğŸ± <span id="date-display">ì˜¤ëŠ˜</span>ì˜ ì ì‹¬</h3>
        
        <div id="meal-box" class="menu">ë©”ë‰´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        
        <div id="kcal-box" class="kcal"></div>
    </div>

    <script>
        // â–¼â–¼â–¼ ë°œê¸‰ë°›ì€ ì¸ì¦í‚¤ë¥¼ ë”°ì˜´í‘œ ì•ˆì— ë„£ì–´ì£¼ì„¸ìš” â–¼â–¼â–¼
        const API_KEY = 'eddddf6d86cc4953a00248d7496c0c8a'; 
        // â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²

        const EDU_CODE = 'J10'; // ê²½ê¸°ë„êµìœ¡ì²­
        const SCH_CODE = '7531167'; // ì†¡ì–‘ê³ ë“±í•™êµ
        
        // ë‚ ì§œ ë° ìš”ì¼ ê³„ì‚°
        const now = new Date();
        const year = now.getFullYear();
        const month = ('0' + (now.getMonth() + 1)).slice(-2);
        const day = ('0' + now.getDate()).slice(-2);
        const dateStr = `${year}${month}${day}`;

        // [ìˆ˜ì •ëœ ë¶€ë¶„] ìš”ì¼ ë°°ì—´ ì¶”ê°€ ë° í‘œì‹œ í˜•ì‹ ë³€ê²½
        const days = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
        const dayOfWeek = days[now.getDay()];
        
        // ì˜ˆ: "12ì›” 4ì¼(ëª©)" í˜•íƒœë¡œ í‘œì‹œ
        document.getElementById('date-display').innerText = `${now.getMonth() + 1}ì›” ${now.getDate()}ì¼(${dayOfWeek})`;

        // 2. API ì£¼ì†Œ ìƒì„±
        // í•µì‹¬: &MMEAL_SC_CODE=2 (ì´ ë¶€ë¶„ì´ 'ì¤‘ì‹'ë§Œ ê°€ì ¸ì˜¤ê²Œ í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤)
        const url = `https://open.neis.go.kr/hub/mealServiceDietInfo?Type=json&KEY=${API_KEY}&ATPT_OFCDC_SC_CODE=${EDU_CODE}&SD_SCHUL_CODE=${SCH_CODE}&MLSV_YMD=${dateStr}&MMEAL_SC_CODE=2`;

        fetch(url)
            .then(response => response.json())
            .then(data => {
                const mealBox = document.getElementById('meal-box');
                const kcalBox = document.getElementById('kcal-box');

                // ë°ì´í„°ê°€ ì •ìƒì¸ì§€ í™•ì¸
                if (data.mealServiceDietInfo) {
                    // ì ì‹¬ ë°ì´í„° ì¶”ì¶œ
                    const row = data.mealServiceDietInfo[1].row[0];
                    let menu = row.DDISH_NM;
                    let kcal = row.CAL_INFO;

                    // ë³´ê¸° ì‹«ì€ ê¸°í˜¸ë“¤ ì œê±° (ì•Œë ˆë¥´ê¸° ë²ˆí˜¸, ì¤„ë°”ê¿ˆ íƒœê·¸ ë“±)
                    menu = menu.replace(/\([0-9\.]+\)/g, '').replace(/<br\/>/g, '\n');
                    
                    mealBox.innerText = menu;
                    kcalBox.innerText = `ì—´ëŸ‰: ${kcal}`;
                } else {
                    // ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° (ì£¼ë§, ê³µíœ´ì¼, ì¬ëŸ‰íœ´ì—…ì¼ ë“±)
                    // ì—ëŸ¬ ë©”ì‹œì§€ ëŒ€ì‹  "ê¸‰ì‹ì´ ì—†ìŠµë‹ˆë‹¤"ë¼ê³  ê¹”ë”í•˜ê²Œ í‘œì‹œ
                    mealBox.innerText = "ì˜¤ëŠ˜ì€ ê¸‰ì‹ì´ ì—†ìŠµë‹ˆë‹¤.";
                }
            })
            .catch(err => {
                console.error(err);
                document.getElementById('meal-box').innerText = "ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
            });
    </script>
</body>
</html>
